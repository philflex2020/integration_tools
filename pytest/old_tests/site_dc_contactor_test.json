{
    "name": "Maintenance Mode Commands - Site DC Contactor Test",
    "tests": [
        {
            "id": "0",
            "name": "Initial State - All ESS DC Contactors Open and Units Stopped",
            "testbeds": [
                "0"
            ],
            "variables": [
                {
                    "var": "ess_id",
                    "description": "range(1, 74, 1)",
                    "type": "string",
                    "size": 2
                }
            ],
            "steps": [
                {
                    "controller": "site_controller",
                    "action": "fims_set",
                    "uri": "/site/operation/disable_flag",
                    "value": true
                },
                {
                    "controller": "site_controller",
                    "action": "pause",
                    "uri": "",
                    "value": 5
                },
                {
                    "controller": "site_controller",
                    "action": "fims_set",
                    "uri": "/site/operation/disable_flag",
                    "value": false
                }
            ],
            "result": [
                {
                    "controller": "site_controller",
                    "action": "fims_get",
                    "waiting": 1,
                    "uri": "/site/operation/site_status",
                    "value": [
                        {
                            "value": "Ready",
                            "name": "Site Controller Status",
                            "unit": "",
                            "scaler": 1,
                            "enabled": true,
                            "type": "string",
                            "ui_type": "status"
                        }
                    ]
                },
                {
                    "controller": "site_controller",
                    "action": "fims_get",
                    "waiting": 1,
                    "uri": "/assets/ess/summary/num_ess_available",
                    "value": [
                        {
                            "naked_value": 74
                        }
                    ]
                },
                {
                    "controller": "site_controller",
                    "action": "fims_get",
                    "waiting": 1,
                    "uri": "/assets/ess/ess_<ess_id>/status",
                    "value": [
                        {
                            "naked_value": "Stop"
                        }
                    ]
                },
                {
                    "controller": "site_controller",
                    "action": "fims_get",
                    "waiting": 1,
                    "uri": "/assets/ess/ess_<ess_id>/open_dc_contactors",
                    "value": [
                        {
                            "enabled": true,
                            "options": [
                                {
                                    "name": "Off",
                                    "return_value": true
                                },
                                {
                                    "name": "On",
                                    "return_value": false
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "id": "1",
            "name": "Put BESS <ess_id> into maintenance mode and close DC contactors",
            "testbeds": [
                "0"
            ],
            "variables": [
                {
                    "var": "ess_id",
                    "description": "range(1, 74, 1)",
                    "type": "string",
                    "size": 2
                }
            ],
            "steps": [
                {
                    "controller": "site_controller",
                    "action": "fims_set",
                    "uri": "/assets/ess/ess_<ess_id>/maint_mode",
                    "value": true
                },
                {
                    "controller": "site_controller",
                    "action": "fims_set",
                    "uri": "/assets/ess/ess_<ess_id>/close_dc_contactors",
                    "value": true
                }
            ],
            "result": [
                {
                    "controller": "site_controller",
                    "action": "fims_get",
                    "waiting": 1,
                    "uri": "/assets/ess/ess_<ess_id>/maint_mode",
                    "value": [
                        {
                            "value": true,
                            "enabled": true,
                            "options": [
                                {
                                    "name": "No",
                                    "return_value": false
                                },
                                {
                                    "name": "Yes",
                                    "return_value": true
                                }
                            ]
                        }
                    ]
                },
                {
                    "controller": "site_controller",
                    "action": "fims_get",
                    "waiting": 1,
                    "uri": "/assets/ess/ess_<ess_id>/close_dc_contactors",
                    "value": [
                        {
                            "enabled": true,
                            "options": [
                                {
                                    "name": "On",
                                    "return_value": true
                                },
                                {
                                    "name": "Off",
                                    "return_value": false
                                }
                            ]
                        }
                    ]
                },
                {
                    "controller": "site_controller",
                    "action": "fims_get",
                    "waiting": 1,
                    "uri": "/assets/ess/ess_<ess_id>/dc_contactors_closed",
                    "value": [
                        {
                            "naked_value": true
                        }
                    ]
                }
            ]
        },
        {
            "id": "2",
            "name": "Open DC contactors for BESS <ess_id>",
            "testbeds": [
                "0"
            ],
            "variables": [
                {
                    "var": "ess_id",
                    "description": "range(1, 74, 1)",
                    "type": "string",
                    "size": 2
                }
            ],
            "steps": [
                {
                    "controller": "site_controller",
                    "action": "fims_set",
                    "uri": "/assets/ess/ess_<ess_id>/open_dc_contactors",
                    "value": true
                },
                {
                    "controller": "site_controller",
                    "action": "fims_set",
                    "uri": "/assets/ess/ess_<ess_id>/maint_mode",
                    "value": false
                }
            ],
            "result": [
                {
                    "controller": "site_controller",
                    "action": "fims_get",
                    "waiting": 1,
                    "uri": "/assets/ess/ess_<ess_id>/open_dc_contactors",
                    "value": [
                        {
                            "enabled": true,
                            "options": [
                                {
                                    "name": "On",
                                    "return_value": false
                                },
                                {
                                    "name": "Off",
                                    "return_value": true
                                }
                            ]
                        }
                    ]
                },
                {
                    "controller": "site_controller",
                    "action": "fims_get",
                    "waiting": 1,
                    "uri": "/assets/ess/ess_<ess_id>/dc_contactors_closed",
                    "value": [
                        {
                            "naked_value": false
                        }
                    ]
                }
            ]
        }
    ],
    "testbeds": [
        {
            "id": "0",
            "name": "Local Site Docker",
            "controllers": [
                {
                    "id": "site_controller",
                    "name": "site_controller",
                    "user": "flexgen",
                    "pass": "flexgen1A!"
                },
                {
                    "id": "twins",
                    "name": "twins",
                    "user": "",
                    "pass": ""
                }
            ]
        }
    ]
}